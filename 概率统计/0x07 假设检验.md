# 数理统计·3 假设检验

## 考纲内容

- 显著性检验
- 假设检验的两类错误
- 单个及两个正态总体的均值和方差的假设检验

1. 理解显著性检验的基本思想，掌握假设检验的基本步骤，了解假设检验可能产生的两类错误
2. 掌握单个及两个正态总体的均值和方差的假设检验

要深入理解显著性检验和假设检验，掌握其步骤，并探讨单个与两个正态总体均值和方差的假设检验，我们可以从以下几个关键点逐步展开分析：



## 一、显著性检验的基本思想与假设检验的基本步骤

### 0x00 显著性检验的基本思想
显著性检验的核心在于检验一个**样本**中的观测结果是否足够偏离**零假设**的预测，从而判断该结果是否具有统计显著性，或者说它是否有可能由**随机因素**引起。通过显著性检验，我们可以决定是否拒绝原假设（$H_0$），即判断数据中的变化是否可能只是**随机波动**的结果。

显著性检验的基本思想可以总结为如下步骤：

1. **设定原假设 $H_0$**：这是一个假设，通常是“无效果”或“无差异”的情况。例如，假设总体均值为特定值。
   
2. **选择显著性水平 $\alpha$**：这代表我们愿意容忍的第一类错误（即错误地拒绝原假设的概率），通常为0.05或0.01。

3. **计算检验统计量**：根据样本数据计算适当的检验统计量，以测量样本数据与原假设的偏离程度。常见的检验统计量包括t统计量、z统计量等。

4. **确定P值或临界值**：通过检验统计量计算对应的P值，或者将其与临界值进行比较。P值表示在假设 $H_0$ 成立的前提下，观察到当前样本或更极端情况的概率。

5. **得出结论**：根据P值或临界值的比较结果决定是否拒绝原假设。

### 0x01 假设检验的基本步骤
假设检验是显著性检验的一个具体应用，其步骤如下：

1. **提出假设**：
   - 原假设（$H_0$）：通常是我们想要证伪的命题。
   - 备择假设（$H_1$）：原假设被拒绝时可能成立的情况。

2. **选择检验统计量和显著性水平** $\alpha$：
   - 根据研究问题和数据类型选择合适的统计量（如t统计量或z统计量）。
   - 设定显著性水平 $\alpha$（例如0.05）。

3. **计算检验统计量和P值**：
   - 基于样本数据计算检验统计量并求P值。

4. **做出决策**：
   - 若P值小于 $\alpha$，则拒绝原假设 $H_0$（说明结果显著）。
   - 若P值大于 $\alpha$，则无法拒绝原假设。

5. **解释结论**：
   - 根据决策，得出对原假设是否可以拒绝的结论。

### 0x02 假设检验的两类错误
在假设检验中，可能产生两类错误：

1. **第一类错误（Type I Error）**：
   - 定义：在原假设 $H_0$ 为真时错误地拒绝了 $H_0$。
   - 发生概率为显著性水平 $\alpha$。
   - 第一类错误也称为“假阳性”。

2. **第二类错误（Type II Error）**：
   - 定义：在原假设 $H_0$ 为假时没有拒绝 $H_0$。
   - 第二类错误的概率通常记作 $\beta$，其补数（$1 - \beta$）称为检验的功效。
   - 第二类错误也称为“假阴性”。

显著性水平 $\alpha$ 和功效 $1 - \beta$ 在检验设计中往往需要权衡。降低 $\alpha$（减少第一类错误）会增加第二类错误的概率，因此需要根据研究背景合理设置。



## 二、单个和两个正态总体的均值和方差的假设检验

### 0x00 单个正态总体均值的假设检验
假设我们有一个**单个正态总体**，希望检验该总体均值 $\mu$ 是否为某一特定值 $\mu_0$。

#### 1. 单个正态总体均值的 t 检验
当总体方差 $\sigma^2$ 未知时，通常使用t检验来检验总体均值：

1. **设定假设**：
   - $H_0: \mu = \mu_0$
   - $H_1: \mu \neq \mu_0$（双侧检验），或 $H_1: \mu > \mu_0$ / $H_1: \mu < \mu_0$（单侧检验）

2. **检验统计量**：计算样本均值 $\bar{X}$，则t统计量为
   $$
   t = \frac{\bar{X} - \mu_0}{S / \sqrt{n}}
   $$
   其中，$S$ 为样本标准差，$n$ 为样本量。

3. **计算P值或临界值**：根据自由度 $df = n - 1$，在t分布表中查找对应的临界值或计算P值。

4. **得出结论**：比较t统计量和临界值，或P值与显著性水平。

#### 2. 单个正态总体方差的假设检验
当检验**单个正态总体的方差**是否为某一值时，使用$\chi^2$检验：

1. **设定假设**：
   - $H_0: \sigma^2 = \sigma_0^2$
   - $H_1: \sigma^2 \neq \sigma_0^2$

2. **检验统计量**：使用以下统计量
   $$
   \chi^2 = \frac{(n - 1) S^2}{\sigma_0^2}
   $$
   其中 $S^2$ 为样本方差。

3. **计算P值或临界值**：在 $\chi^2$ 分布表中查找对应的临界值或计算P值。

4. **得出结论**：根据$\chi^2$统计量与临界值或P值决定是否拒绝 $H_0$。



### 0x01 两个正态总体均值的假设检验

在比较**两个独立正态总体**的均值差异时，通常使用两样本t检验。

#### 1. 两个正态总体均值的 t 检验
当两个总体的方差相等或不等时，使用不同的t检验方法。

1. **设定假设**：
   - $H_0: \mu_1 = \mu_2$
   - $H_1: \mu_1 \neq \mu_2$

2. **检验统计量**：对于**方差相等**的情况，合并样本方差 $S_p^2$ 并计算t统计量
   $$
   t = \frac{\bar{X}_1 - \bar{X}_2}{S_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}
   $$
   其中
   $$
   S_p^2 = \frac{(n_1 - 1)S_1^2 + (n_2 - 1)S_2^2}{n_1 + n_2 - 2}
   $$

3. **自由度**： $df = n_1 + n_2 - 2$

4. **计算P值或临界值**：在t分布表中查找对应的临界值或计算P值。

#### 2. 两个正态总体方差的假设检验
当比较**两个正态总体方差**是否相等时，使用F检验。

1. **设定假设**：
   - $H_0: \sigma_1^2 = \sigma_2^2$
   - $H_1: \sigma_1^2 \neq \sigma_2^2$

2. **检验统计量**：F 统计量定义为
   $$
   F = \frac{S_1^2}{S_2^2}
   $$
   
   其中 $S_1^2$ 和 $S_2^2$ 为两个样本的方差，且假设 $S_1^2 > S_2^2$。
   
3. **计算P值或临界值**：根据 $df_1 = n_1 - 1$ 和 $df_2 = n_2 - 1$ 查找F分布表中的临界值或计算P值。

4. **得出结论**：比较F统计量与F分布的临界值或P值决定是否拒绝 $H_0$。

